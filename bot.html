<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Phone Duel</title>
<link rel="stylesheet" href="style.css">
<style>
.bot-game-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
    margin-top: 30px;
}
.player-panel, .bot-panel {
    background: var(--card-bg);
    border-radius: 20px;
    padding: 25px;
    min-height: 550px;
    border: 2px solid;
    transition: all 0.3s;
}
.player-panel {
    border-color: var(--accent);
    box-shadow: 0 0 30px rgba(8, 240, 255, 0.2);
}
.bot-panel {
    border-color: #8a2be2;
    box-shadow: 0 0 30px rgba(138, 43, 226, 0.2);
}
.panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid;
}
.player-header {
    border-color: var(--accent-light);
}
.bot-header {
    border-color: rgba(138, 43, 226, 0.3);
}
.panel-title {
    font-size: 24px;
    font-weight: bold;
}
.player-title {
    color: var(--accent);
}
.bot-title {
    color: #8a2be2;
}
.difficulty-badge {
    background: linear-gradient(90deg, #8a2be2, #9370db);
    color: white;
    padding: 5px 15px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: bold;
}
.phone-display {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 25px;
    border: 1px solid;
    min-height: 180px;
}
.player-phone {
    border-color: var(--accent-light);
}
.bot-phone {
    border-color: rgba(138, 43, 226, 0.3);
}
.phone-name {
    font-size: 20px;
    color: var(--success);
    margin-bottom: 10px;
    text-align: center;
}
.phone-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    font-size: 14px;
    color: var(--text-secondary);
}
.bot-thinking {
    text-align: center;
    padding: 20px;
    color: #a0a0ff;
    font-style: italic;
}
.attributes-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 10px;
    margin-bottom: 25px;
}
.attr-btn {
    background: rgba(16, 16, 38, 0.8);
    border: 1px solid var(--accent-light);
    border-radius: 8px;
    padding: 12px;
    color: white;
    cursor: pointer;
    font-family: 'Share Tech Mono', monospace;
    transition: all 0.2s;
    text-align: center;
    font-size: 14px;
}
.attr-btn:hover:not(:disabled) {
    background: rgba(8, 240, 255, 0.2);
    border-color: var(--accent);
    transform: translateY(-2px);
}
.attr-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}
.attr-btn.used {
    background: rgba(138, 43, 226, 0.2);
    border-color: #8a2be2;
}
.guess-section {
    margin-top: 20px;
}
.guess-input {
    width: 100%;
    padding: 15px;
    background: rgba(16, 16, 38, 0.8);
    border: 1px solid var(--accent-light);
    border-radius: 10px;
    color: white;
    font-size: 16px;
    margin-bottom: 15px;
    font-family: 'Share Tech Mono', monospace;
}
.guess-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 15px rgba(8, 240, 255, 0.3);
}
.guess-btn {
    width: 100%;
    padding: 15px;
    background: linear-gradient(90deg, var(--accent), var(--success));
    border: none;
    border-radius: 10px;
    color: black;
    font-weight: bold;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
    font-family: 'Orbitron', sans-serif;
}
.guess-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(8, 240, 255, 0.3);
}
.guess-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
.game-log {
    grid-column: 1 / -1;
    background: rgba(10, 10, 24, 0.9);
    border: 1px solid var(--accent-light);
    border-radius: 15px;
    padding: 20px;
    margin-top: 30px;
    max-height: 200px;
    overflow-y: auto;
}
.log-title {
    color: var(--accent);
    margin-bottom: 15px;
    font-size: 18px;
}
.log-content {
    font-size: 14px;
    line-height: 1.6;
    color: var(--text-secondary);
}
.log-item {
    margin-bottom: 8px;
    padding: 8px;
    border-radius: 5px;
    background: rgba(16, 16, 38, 0.5);
    border-left: 3px solid var(--accent);
}
.log-item.bot {
    border-left-color: #8a2be2;
    background: rgba(138, 43, 226, 0.1);
}
.bot-stats {
    margin-top: 20px;
    padding: 15px;
    background: rgba(138, 43, 226, 0.1);
    border-radius: 10px;
    border: 1px solid rgba(138, 43, 226, 0.3);
}
.stat-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 14px;
}
.stat-label {
    color: #a0a0ff;
}
.stat-value {
    color: #8a2be2;
    font-weight: bold;
}
.game-controls {
    grid-column: 1 / -1;
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 30px;
}
.control-btn {
    padding: 15px 30px;
    border-radius: 10px;
    border: none;
    font-family: 'Orbitron', sans-serif;
    font-weight: bold;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
}
.next-turn {
    background: linear-gradient(90deg, var(--accent), var(--success));
    color: black;
}
.restart {
    background: linear-gradient(90deg, #8a2be2, #9370db);
    color: white;
}
.control-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}
.suggestion-list {
    max-height: 150px;
    overflow-y: auto;
    background: rgba(16, 16, 38, 0.9);
    border: 1px solid var(--accent-light);
    border-radius: 8px;
    margin-top: 5px;
    display: none;
    position: absolute;
    width: calc(100% - 30px);
    z-index: 100;
}
.suggestion-item {
    padding: 10px;
    cursor: pointer;
    transition: all 0.2s;
}
.suggestion-item:hover {
    background: rgba(8, 240, 255, 0.2);
}
.turn-indicator {
    text-align: center;
    font-size: 20px;
    color: var(--accent);
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(8, 240, 255, 0.1);
    border-radius: 10px;
    border: 2px solid var(--accent);
    animation: pulse 2s infinite;
}
.modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    align-items: center;
    justify-content: center;
}
.modal-content {
    background: var(--card-bg);
    border: 3px solid var(--accent);
    border-radius: 20px;
    padding: 40px;
    max-width: 500px;
    width: 90%;
    text-align: center;
    animation: modalAppear 0.5s;
}
@keyframes modalAppear {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}
.modal-title {
    font-size: 32px;
    color: var(--accent);
    margin-bottom: 20px;
    text-shadow: 0 0 20px currentColor;
}
.modal-message {
    font-size: 18px;
    color: var(--text-primary);
    margin-bottom: 30px;
    line-height: 1.6;
}
.bot-analysis {
    background: rgba(138, 43, 226, 0.1);
    border-radius: 10px;
    padding: 15px;
    margin: 20px 0;
    font-size: 14px;
    text-align: left;
    border: 1px solid rgba(138, 43, 226, 0.3);
}
@media (max-width: 900px) {
    .bot-game-container {
        grid-template-columns: 1fr;
    }
    .phone-details {
        grid-template-columns: 1fr;
    }
    .attributes-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    }
}
</style>
</head>
<body>
<button class="back-btn" onclick="window.location.href='index.html'">← Назад</button>

<div class="container">
    <h1>Phone Duel</h1>
    
    <div class="turn-indicator" id="turnIndicator">Ваш ход!</div>
    
    <div class="bot-game-container">
        <div class="player-panel">
            <div class="panel-header player-header">
                <div class="panel-title player-title" id="playerName">Игрок</div>
                <div class="player-turn" id="playerTurnStatus">ХОДИТ</div>
            </div>
            
            <div class="phone-display player-phone">
                <div class="phone-name">Ваш телефон:</div>
                <div class="phone-details" id="playerPhoneDetails"></div>
            </div>
            
            <div class="attributes-grid" id="playerAttributes"></div>
            
            <div class="guess-section">
                <div style="position: relative;">
                    <input type="text" class="guess-input" id="playerGuess" placeholder="Угадайте телефон бота..." autocomplete="off">
                    <div class="suggestion-list" id="playerSuggestions"></div>
                </div>
                <button class="guess-btn" id="playerGuessBtn" disabled>УГАДАТЬ</button>
            </div>
        </div>
        
        <div class="bot-panel">
            <div class="panel-header bot-header">
                <div class="panel-title bot-title">Бот</div>
                <div class="difficulty-badge" id="botDifficulty">Легкий</div>
            </div>
            
            <div class="phone-display bot-phone">
                <div class="phone-name">Телефон бота:</div>
                <div class="phone-details" id="botPhoneDetails">???</div>
            </div>
            
            <div class="bot-thinking" id="botThinking">
                Бот анализирует ходы...
            </div>
            
            <div class="bot-stats">
                <div class="stat-item">
                    <span class="stat-label">Известных характеристик:</span>
                    <span class="stat-value" id="botKnownCount">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Возможных телефонов:</span>
                    <span class="stat-value" id="botPossibleCount">24</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Вероятность угадать:</span>
                    <span class="stat-value" id="botProbability">0%</span>
                </div>
            </div>
        </div>
        
        <div class="game-log">
            <div class="log-title">Ход игры</div>
            <div class="log-content" id="gameLog"></div>
        </div>
        
        <div class="game-controls">
            <button class="control-btn next-turn" id="nextTurnBtn">ХОД БОТА →</button>
            <button class="control-btn restart" onclick="restartGame()">НОВАЯ ИГРА</button>
            <button class="control-btn" onclick="window.location.href='index.html'" style="background: linear-gradient(90deg, #666, #999); color: white;">
                В МЕНЮ
            </button>
        </div>
    </div>
</div>

<div class="modal-overlay" id="resultModal">
    <div class="modal-content">
        <div class="modal-title" id="resultTitle">РЕЗУЛЬТАТ</div>
        <div class="modal-message" id="resultMessage"></div>
        <div class="bot-analysis" id="botAnalysis"></div>
        <button class="guess-btn" onclick="restartGame()" style="margin-bottom: 15px;">ИГРАТЬ СНОВА</button>
        <button class="guess-btn" onclick="window.location.href='index.html'" style="background: linear-gradient(90deg, #666, #999);">
            В МЕНЮ
        </button>
    </div>
</div>

<audio id="bgMusic" loop>
    <source src="cyberpunk_music.mp3" type="audio/mpeg">
</audio>
<button id="musicToggle" class="music-btn">Музыка: ON</button>

<script src="game.js"></script>
<script>
let gameState = {
    player: { name: 'Игрок', phone: null, usedAttributes: new Set(), knownAttributes: {}, isActive: true },
    bot: { phone: null, usedAttributes: new Set(), knownAttributes: {}, possiblePhones: [], difficulty: 'easy', isActive: false },
    currentTurn: 'player',
    round: 1,
    maxRounds: 15,
    gameActive: true
};

document.addEventListener('DOMContentLoaded', () => {
    const playerName = localStorage.getItem('playerName') || 'Игрок';
    const difficulty = localStorage.getItem('botDifficulty') || 'easy';
    
    document.getElementById('playerName').textContent = playerName;
    document.getElementById('botDifficulty').textContent = 
        difficulty === 'easy' ? 'Легкий' : 
        difficulty === 'medium' ? 'Средний' : 'Сложный';
    
    gameState.player.name = playerName;
    gameState.bot.difficulty = difficulty;
    
    startNewGame();
    setupEventListeners();
    setupMusic();
    
    addToLog('Началась дуэль с ботом!');
});

function startNewGame() {
    gameState = {
        player: { name: gameState.player.name, phone: null, usedAttributes: new Set(), knownAttributes: {}, isActive: true },
        bot: { phone: null, usedAttributes: new Set(), knownAttributes: {}, possiblePhones: [...phones], difficulty: gameState.bot.difficulty, isActive: false },
        currentTurn: 'player',
        round: 1,
        maxRounds: 15,
        gameActive: true
    };
    
    gameState.player.phone = getRandomPhone();
    do {
        gameState.bot.phone = getRandomPhone();
    } while (gameState.bot.phone.name === gameState.player.phone.name);
    
    updatePlayerPhoneDisplay();
    updateBotStats();
    createAttributeButtons();
    updateTurnIndicator();
    
    setPlayerTurn(true);
}

function updatePlayerPhoneDisplay() {
    const phone = gameState.player.phone;
    const details = document.getElementById('playerPhoneDetails');
    
    details.innerHTML = `
        <div><strong>Модель:</strong> ${phone.name}</div>
        <div><strong>Процессор:</strong> ${phone.processor}</div>
        <div><strong>Аккумулятор:</strong> ${phone.battery}</div>
        <div><strong>Камера:</strong> ${phone.camera}</div>
        <div><strong>Экран:</strong> ${phone.screen}</div>
        <div><strong>Материалы:</strong> ${phone.materials}</div>
        <div><strong>Зарядка:</strong> ${phone.charging}</div>
        <div><strong>Цена:</strong> $${phone.price}</div>
        <div><strong>Память:</strong> ${phone.storage}</div>
        <div><strong>ОС:</strong> ${phone.os}</div>
        <div><strong>Вес:</strong> ${phone.weight}</div>
    `;
}

function updateBotStats() {
    const knownCount = Object.keys(gameState.bot.knownAttributes).length;
    const possibleCount = gameState.bot.possiblePhones.length;
    const probability = possibleCount > 0 ? Math.round((1 / possibleCount) * 100) : 0;
    
