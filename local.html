<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Phone Duel</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
    --bg-primary: #0a0a16;
    --bg-secondary: #111128;
    --accent: #08f0ff;
    --accent-light: rgba(8, 240, 255, 0.3);
    --success: #00ff88;
    --text-primary: #ffffff;
    --text-secondary: #a0a0c0;
    --card-bg: rgba(20, 20, 40, 0.7);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Share Tech Mono', monospace;
    background: linear-gradient(135deg, #0a0a16 0%, #1a1a3a 100%);
    color: var(--text-primary);
    min-height: 100vh;
    background-attachment: fixed;
    overflow-x: hidden;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
    display: flex;
    gap: 20px;
}

.back-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    background: rgba(20, 20, 40, 0.8);
    border: 2px solid var(--accent);
    color: var(--accent);
    padding: 10px 20px;
    border-radius: 10px;
    font-family: 'Orbitron', sans-serif;
    font-size: 16px;
    cursor: pointer;
    z-index: 1000;
    transition: all 0.3s;
}

.back-btn:hover {
    background: var(--accent);
    color: #000;
    transform: translateX(-5px);
}

h1 {
    font-family: 'Orbitron', sans-serif;
    font-size: 48px;
    text-align: center;
    margin: 20px 0 40px;
    color: var(--accent);
    text-shadow: 0 0 20px currentColor;
    letter-spacing: 2px;
}

.music-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(20, 20, 40, 0.8);
    border: 2px solid var(--accent);
    color: var(--accent);
    padding: 10px 20px;
    border-radius: 10px;
    font-family: 'Orbitron', sans-serif;
    font-size: 14px;
    cursor: pointer;
    z-index: 1000;
    transition: all 0.3s;
}

.music-btn:hover {
    background: var(--accent);
    color: #000;
}

/* –ë–æ–∫–æ–≤—ã–µ –º–µ–Ω—é —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ */
.player-sidebar {
    width: 300px;
    background: var(--card-bg);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid var(--accent-light);
    height: fit-content;
}

.player-sidebar-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 20px;
    color: var(--accent);
    margin-bottom: 20px;
    text-align: center;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--accent-light);
}

.attributes-sidebar {
    display: flex;
    flex-direction: column;
    gap: 15px;
    max-height: 500px;
    overflow-y: auto;
}

.attribute-sidebar-item {
    background: rgba(16, 16, 38, 0.6);
    border-radius: 10px;
    padding: 15px;
    border: 1px solid var(--accent-light);
    transition: all 0.3s;
}

.attribute-sidebar-item:hover {
    transform: translateX(5px);
    border-color: var(--accent);
}

.attribute-name {
    color: var(--success);
    font-weight: bold;
    margin-bottom: 5px;
    font-size: 14px;
}

.attribute-value {
    color: white;
    font-size: 16px;
}

.no-attributes {
    text-align: center;
    color: var(--text-secondary);
    padding: 20px;
    font-style: italic;
}

/* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∏–≥—Ä—ã */
.game-center {
    flex: 1;
    max-width: 800px;
}

.turn-banner {
    text-align: center;
    font-size: 24px;
    color: var(--accent);
    margin: 0 0 30px 0;
    padding: 20px;
    background: rgba(8, 240, 255, 0.1);
    border-radius: 15px;
    border: 2px solid var(--accent);
    animation: pulse 2s infinite;
}

.player-info-card {
    display: flex;
    align-items: center;
    gap: 30px;
    background: var(--card-bg);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
    border: 2px solid var(--accent-light);
}

.player-avatar {
    font-size: 60px;
    width: 100px;
    text-align: center;
}

.player-details {
    flex: 1;
}

.player-name {
    font-size: 28px;
    color: var(--accent);
    margin-bottom: 10px;
    font-family: 'Orbitron', sans-serif;
}

.player-stats {
    display: flex;
    gap: 30px;
    margin-top: 15px;
}

.stat-box {
    background: rgba(16, 16, 38, 0.6);
    border-radius: 10px;
    padding: 10px 20px;
    text-align: center;
    border: 1px solid var(--accent-light);
}

.stat-value {
    font-size: 24px;
    color: var(--accent);
    font-weight: bold;
}

.stat-label {
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 5px;
}

.phone-info-compact {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    padding: 20px;
    margin-top: 20px;
    border: 1px solid var(--accent-light);
}

.compact-phone-name {
    color: var(--success);
    font-size: 18px;
    margin-bottom: 10px;
    text-align: center;
}

.compact-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    font-size: 14px;
    color: var(--text-secondary);
}

/* –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
.main-action-buttons {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-top: 40px;
}

.action-btn {
    padding: 20px 40px;
    border-radius: 15px;
    border: none;
    font-family: 'Orbitron', sans-serif;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
    min-width: 200px;
}

.btn-ask {
    background: linear-gradient(90deg, var(--accent), var(--success));
    color: black;
}

.btn-guess {
    background: linear-gradient(90deg, #ff0878, #ff8c00);
    color: white;
}

.btn-next {
    background: linear-gradient(90deg, #666, #999);
    color: white;
}

.action-btn:hover:not(:disabled) {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
}

.action-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* –ë–ª–æ–∫ –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è */
.after-action-buttons {
    background: var(--card-bg);
    border-radius: 20px;
    padding: 30px;
    margin-top: 30px;
    border: 2px solid var(--accent-light);
    text-align: center;
    display: none;
}

.after-action-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 22px;
    color: var(--accent);
    margin-bottom: 25px;
}

.after-action-content {
    display: flex;
    flex-direction: column;
    gap: 20px;
    align-items: center;
}

.after-action-row {
    display: flex;
    gap: 20px;
    justify-content: center;
    width: 100%;
}

/* –ü–æ–ª–µ –¥–ª—è —É–≥–∞–¥—ã–≤–∞–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ */
.guess-container {
    display: flex;
    gap: 15px;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 600px;
    position: relative;
}

.guess-input {
    flex: 1;
    padding: 15px 20px;
    background: rgba(16, 16, 38, 0.8);
    border: 2px solid var(--accent);
    border-radius: 12px;
    color: white;
    font-size: 18px;
    font-family: 'Share Tech Mono', monospace;
}

.guess-input::placeholder {
    color: #666;
}

.guess-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: rgba(16, 16, 38, 0.95);
    border: 1px solid var(--accent-light);
    border-radius: 10px;
    margin-top: 5px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
}

.suggestion-item {
    padding: 12px 15px;
    cursor: pointer;
    transition: all 0.2s;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.suggestion-item:hover {
    background: rgba(8, 240, 255, 0.2);
}

/* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
.fullscreen-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 10000;
    overflow-y: auto;
    padding: 20px;
}

.modal-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--accent);
}

.modal-title {
    font-size: 36px;
    color: var(--accent);
    margin-bottom: 10px;
    text-shadow: 0 0 20px currentColor;
}

.modal-subtitle {
    color: var(--text-secondary);
    font-size: 18px;
}

.attributes-grid-modal {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    max-width: 1000px;
    margin: 0 auto 40px;
}

.attr-card {
    background: var(--card-bg);
    border: 2px solid var(--accent-light);
    border-radius: 15px;
    padding: 25px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
}

.attr-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(8, 240, 255, 0.3);
    border-color: var(--accent);
}

.attr-card.used {
    background: rgba(138, 43, 226, 0.2);
    border-color: #8a2be2;
    cursor: not-allowed;
    opacity: 0.7;
}

.attr-icon {
    font-size: 32px;
    margin-bottom: 15px;
}

.attr-name {
    font-size: 18px;
    color: var(--accent);
    margin-bottom: 10px;
}

.close-modal-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid var(--accent);
    border-radius: 50%;
    width: 60px;
    height: 60px;
    color: var(--accent);
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10001;
}

.close-modal-btn:hover {
    background: var(--accent);
    color: black;
    transform: rotate(90deg);
}

.result-reveal {
    text-align: center;
    padding: 40px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 20px;
    margin: 30px auto;
    max-width: 600px;
    border: 3px solid var(--accent);
    animation: glow 2s infinite;
}

.result-phone-name {
    font-size: 32px;
    color: var(--success);
    margin: 20px 0;
}

.result-stats {
    display: flex;
    justify-content: center;
    gap: 40px;
    margin-top: 30px;
}

.result-stat {
    text-align: center;
}

.result-value {
    font-size: 28px;
    color: var(--accent);
    font-weight: bold;
}

.result-label {
    color: var(--text-secondary);
    font-size: 14px;
    margin-top: 5px;
}

.end-game-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 10000;
    display: none;
    overflow-y: auto;
    padding: 20px;
}

.end-game-content {
    text-align: center;
    padding: 40px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 20px;
    margin: 50px auto;
    max-width: 800px;
    border: 3px solid var(--accent);
}

@keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(8, 240, 255, 0.4); }
    70% { box-shadow: 0 0 0 10px rgba(8, 240, 255, 0); }
    100% { box-shadow: 0 0 0 0 rgba(8, 240, 255, 0); }
}

@keyframes glow {
    0%, 100% { box-shadow: 0 0 20px rgba(8, 240, 255, 0.5); }
    50% { box-shadow: 0 0 40px rgba(8, 240, 255, 0.8); }
}

@media (max-width: 1200px) {
    .container {
        flex-direction: column;
    }
    
    .player-sidebar {
        width: 100%;
    }
    
    .game-center {
        max-width: 100%;
    }
}

@media (max-width: 768px) {
    .player-info-card {
        flex-direction: column;
        text-align: center;
        gap: 20px;
    }
    
    .player-stats {
        flex-wrap: wrap;
        justify-content: center;
    }
    
    .main-action-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .after-action-row {
        flex-direction: column;
        align-items: center;
    }
    
    .guess-container {
        flex-direction: column;
    }
    
    .guess-input {
        width: 100%;
    }
    
    .action-btn {
        width: 100%;
        max-width: 300px;
    }
    
    .attributes-grid-modal {
        grid-template-columns: 1fr;
    }
}
</style>
</head>
<body>
<button class="back-btn" onclick="window.location.href='index.html'">‚Üê –ù–∞–∑–∞–¥</button>

<div class="container">
    <!-- –õ–µ–≤–æ–µ –º–µ–Ω—é - —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞ 1 -->
    <div class="player-sidebar" id="player1Sidebar">
        <div class="player-sidebar-title" id="player1SidebarTitle">–ò–≥—Ä–æ–∫ 1</div>
        <div class="attributes-sidebar" id="player1Attributes">
            <div class="no-attributes">–ï—â–µ –Ω–µ —Ä–∞—Å–∫—Ä—ã—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</div>
        </div>
    </div>
    
    <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∏–≥—Ä—ã -->
    <div class="game-center">
        <h1>Phone Duel</h1>
        
        <div class="turn-banner" id="turnBanner"></div>
        
        <div class="player-info-card">
            <div class="player-avatar" id="currentPlayerAvatar">üë§</div>
            <div class="player-details">
                <div class="player-name" id="currentPlayerNameDisplay">–ò–≥—Ä–æ–∫ 1</div>
                <div style="color: var(--text-secondary); margin-bottom: 10px;">
                    –¢–µ–ª–µ—Ñ–æ–Ω —Å–æ–ø–µ—Ä–Ω–∏–∫–∞: <span id="opponentPhoneName">???</span>
                </div>
                
                <div class="player-stats">
                    <div class="stat-box">
                        <div class="stat-value" id="knownAttributes">0</div>
                        <div class="stat-label">–ò–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="roundCounter">1</div>
                        <div class="stat-label">–†–∞—É–Ω–¥</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="possiblePhones">24</div>
                        <div class="stat-label">–í–æ–∑–º–æ–∂–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤</div>
                    </div>
                </div>
                
                <div class="phone-info-compact">
                    <div class="compact-phone-name">–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω: <span id="ownPhoneName">???</span></div>
                    <div class="compact-details" id="ownPhoneDetails"></div>
            </div>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="main-action-buttons" id="mainActionButtons">
        <button class="action-btn btn-ask" onclick="openAskModal()">
            –°–ü–†–û–°–ò–¢–¨ –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–£
        </button>
        <button class="action-btn btn-guess" onclick="showGuessField()">
            –£–ì–ê–î–ê–¢–¨ –¢–ï–õ–ï–§–û–ù
        </button>
    </div>
    
    <!-- –ë–ª–æ–∫ –¥–ª—è —É–≥–∞–¥—ã–≤–∞–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
    <div class="after-action-buttons" id="guessField" style="display: none;">
        <div class="after-action-title">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–≥–∞–¥–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω</div>
        <div class="guess-container" style="position: relative;">
            <input type="text" class="guess-input" id="guessInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞...">
            <div class="guess-suggestions" id="guessSuggestions"></div>
        </div>
        <div class="after-action-row" style="margin-top: 20px;">
            <button class="action-btn btn-guess" onclick="submitGuess()" style="min-width: 200px;">
                –£–ì–ê–î–ê–¢–¨
            </button>
            <button class="action-btn btn-next" onclick="cancelGuess()" style="min-width: 200px;">
                –û–¢–ú–ï–ù–ê
            </button>
        </div>
    </div>
    
    <!-- –ë–ª–æ–∫ –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="after-action-buttons" id="afterActionButtons">
        <div class="after-action-title">–•–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω!</div>
        <div class="after-action-content">
            <div style="color: var(--text-secondary); margin-bottom: 20px;">
                –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å —Ö–æ–¥ —Å–ª–µ–¥—É—é—â–µ–º—É –∏–≥—Ä–æ–∫—É
            </div>
            <button class="action-btn btn-next" onclick="nextTurn()" style="min-width: 300px;">
                –ó–ê–ö–û–ù–ß–ò–¢–¨ –•–û–î ‚Üí
            </button>
        </div>
    </div>
</div>

<!-- –ü—Ä–∞–≤–æ–µ –º–µ–Ω—é - —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞ 2 -->
<div class="player-sidebar" id="player2Sidebar">
    <div class="player-sidebar-title" id="player2SidebarTitle">–ò–≥—Ä–æ–∫ 2</div>
    <div class="attributes-sidebar" id="player2Attributes">
        <div class="no-attributes">–ï—â–µ –Ω–µ —Ä–∞—Å–∫—Ä—ã—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</div>
    </div>
</div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
<div class="fullscreen-modal" id="askModal">
<button class="close-modal-btn" onclick="closeAskModal()">‚úï</button>
<div class="modal-header">
    <div class="modal-title">–í—ã–±–æ—Ä —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</div>
    <div class="modal-subtitle" id="askModalSubtitle">–í—ã–±–µ—Ä–∏—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞</div>
</div>

<div class="attributes-grid-modal" id="attributesGrid"></div>

<div style="text-align: center; margin-top: 30px;">
    <button class="action-btn btn-next" onclick="closeAskModal()" style="min-width: 300px;">
        ‚Üê –ù–ê–ó–ê–î
    </button>
</div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -->
<div class="fullscreen-modal" id="resultModal">
<div class="result-reveal">
    <div class="modal-title" id="resultTitle">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∞!</div>
    <div class="modal-subtitle" id="resultSubtitle"></div>
    
    <div style="font-size: 48px; margin: 30px 0;">üéâ</div>
    
    <div class="result-phone-name" id="resultPhoneName"></div>
    
    <div class="result-stats">
        <div class="result-stat">
            <div class="result-value" id="resultAttribute"></div>
            <div class="result-label">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞</div>
        </div>
        <div class="result-stat">
            <div class="result-value" id="resultKnownCount"></div>
            <div class="result-label">–ò–∑–≤–µ—Å—Ç–Ω–æ –≤—Å–µ–≥–æ</div>
        </div>
        <div class="result-stat">
            <div class="result-value" id="resultPossibleCount"></div>
            <div class="result-label">–û—Å—Ç–∞–ª–æ—Å—å –≤–æ–∑–º–æ–∂–Ω—ã—Ö</div>
        </div>
    </div>
    
    <button class="action-btn btn-ask" onclick="closeResultModal()" style="margin-top: 40px; min-width: 300px;">
        –ü–†–û–î–û–õ–ñ–ò–¢–¨
    </button>
</div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã -->
<div class="end-game-modal" id="endGameModal">
<div class="end-game-content">
    <div class="modal-title" id="endGameTitle">–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!</div>
    <div style="font-size: 64px; margin: 30px 0;" id="endGameIcon">üèÜ</div>
    
    <div class="result-phone-name" id="endGameMessage"></div>
    
    <div style="background: rgba(8, 240, 255, 0.1); border-radius: 15px; padding: 25px; margin: 30px 0;">
        <div style="color: var(--accent); font-size: 20px; margin-bottom: 20px; text-align: center;">–¢–µ–ª–µ—Ñ–æ–Ω—ã –∏–≥—Ä–æ–∫–æ–≤:</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div style="background: rgba(0, 0, 0, 0.3); border-radius: 10px; padding: 15px;">
                <div style="color: var(--success); font-weight: bold;" id="player1EndName">–ò–≥—Ä–æ–∫ 1</div>
                <div style="color: white; font-size: 16px;" id="player1EndPhone">???</div>
            </div>
            <div style="background: rgba(0, 0, 0, 0.3); border-radius: 10px; padding: 15px;">
                <div style="color: var(--success); font-weight: bold;" id="player2EndName">–ò–≥—Ä–æ–∫ 2</div>
                <div style="color: white; font-size: 16px;" id="player2EndPhone">???</div>
            </div>
        </div>
    </div>
    
    <div style="display: flex; justify-content: center; gap: 40px; margin-top: 30px;">
        <div style="text-align: center;">
            <div style="font-size: 28px; color: var(--accent); font-weight: bold;" id="endGameRounds">0</div>
            <div style="color: var(--text-secondary); font-size: 14px;">–†–∞—É–Ω–¥–æ–≤</div>
        </div>
        <div style="text-align: center;">
            <div style="font-size: 28px; color: var(--accent); font-weight: bold;" id="endGameTime">0:00</div>
            <div style="color: var(--text-secondary); font-size: 14px;">–í—Ä–µ–º—è</div>
        </div>
    </div>
    
    <div style="display: flex; gap: 20px; justify-content: center; margin-top: 40px;">
        <button class="action-btn btn-ask" onclick="restartGame()" style="min-width: 250px;">
            –ù–û–í–ê–Ø –ò–ì–†–ê
        </button>
        <button class="action-btn btn-next" onclick="window.location.href='index.html'" style="min-width: 250px;">
            –í –ú–ï–ù–Æ
        </button>
    </div>
</div>
</div>

<audio id="bgMusic" loop>
<source src="https://assets.mixkit.co/music/preview/mixkit-tech-house-vibes-130.mp3" type="audio/mpeg">
</audio>
<button id="musicToggle" class="music-btn">–ú—É–∑—ã–∫–∞: ON</button>

<script>
// ========== –ë–ê–ó–ê –î–ê–ù–ù–´–• –¢–ï–õ–ï–§–û–ù–û–í ==========
const phones = [
    {name:"iPhone 16 Pro Max", battery:"4676 mAh", materials:"–¢–∏—Ç–∞–Ω", processor:"A18 Pro", camera:"48+12+12+12 –ú–ü", screen:'6.9" Super Retina XDR 2796x1290 120–ì—Ü', charging:"35 –í—Ç", price:"1299", storage:"1 –¢–ë", os:"iOS 18", weight:"221 –≥", brand:"Apple"},
    {name:"iPhone 16", battery:"3561 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"A17 Pro", camera:"48+12 –ú–ü", screen:'6.1" OLED 2556x1179 60–ì—Ü', charging:"20 –í—Ç", price:"799", storage:"128 –ì–ë", os:"iOS 18", weight:"171 –≥", brand:"Apple"},
    {name:"iPhone SE 4", battery:"3279 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"A16 Bionic", camera:"48 –ú–ü", screen:'6.1" OLED 2532x1170 60–ì—Ü', charging:"20 –í—Ç", price:"499", storage:"128 –ì–ë", os:"iOS 18", weight:"165 –≥", brand:"Apple"},
    {name:"Samsung Galaxy S24 Ultra", battery:"5000 mAh", materials:"–¢–∏—Ç–∞–Ω", processor:"Snapdragon 8 Gen 3", camera:"200+50+12+10 –ú–ü", screen:'6.8" Dynamic AMOLED 3120x1440 120–ì—Ü', charging:"45 –í—Ç", price:"1199", storage:"512 –ì–ë", os:"Android 14", weight:"232 –≥", brand:"Samsung"},
    {name:"Samsung Galaxy S24", battery:"4000 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"Exynos 2400", camera:"50+10+12 –ú–ü", screen:'6.2" Dynamic AMOLED 2340x1080 120–ì—Ü', charging:"25 –í—Ç", price:"799", storage:"256 –ì–ë", os:"Android 14", weight:"167 –≥", brand:"Samsung"},
    {name:"Samsung Galaxy Z Fold6", battery:"4400 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"Snapdragon 8 Gen 3", camera:"50+12+10 –ú–ü", screen:'7.6" Dynamic AMOLED 2176x1812 120–ì—Ü', charging:"25 –í—Ç", price:"1799", storage:"512 –ì–ë", os:"Android 14", weight:"239 –≥", brand:"Samsung"},
    {name:"Google Pixel 9 Pro", battery:"5050 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"Tensor G4", camera:"50+48+48 –ú–ü", screen:'6.7" LTPO OLED 2992x1344 120–ì—Ü', charging:"30 –í—Ç", price:"999", storage:"256 –ì–ë", os:"Android 15", weight:"193 –≥", brand:"Google"},
    {name:"Google Pixel 9", battery:"4575 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"Tensor G4", camera:"50+48 –ú–ü", screen:'6.2" OLED 2400x1080 120–ì—Ü', charging:"27 –í—Ç", price:"699", storage:"128 –ì–ë", os:"Android 15", weight:"168 –≥", brand:"Google"},
    {name:"OnePlus 12", battery:"5400 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+64+48 –ú–ü", screen:'6.82" LTPO AMOLED 3168x1440 120–ì—Ü', charging:"100 –í—Ç", price:"799", storage:"256 –ì–ë", os:"OxygenOS 14", weight:"220 –≥", brand:"OnePlus"},
    {name:"OnePlus Nord 4", battery:"5500 mAh", materials:"–ê–ª—é–º–∏–Ω–∏–π", processor:"Snapdragon 7+ Gen 3", camera:"50+8 –ú–ü", screen:'6.74" Fluid AMOLED 2772x1240 120–ì—Ü', charging:"80 –í—Ç", price:"449", storage:"256 –ì–ë", os:"OxygenOS 14", weight:"190 –≥", brand:"OnePlus"},
    {name:"Xiaomi 14 Ultra", battery:"5300 mAh", materials:"–ù–∞–Ω–æ-–∫–æ–∂–∞ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+50+50+50 –ú–ü", screen:'6.73" LTPO AMOLED 3200x1440 120–ì—Ü', charging:"90 –í—Ç", price:"1299", storage:"512 –ì–ë", os:"HyperOS", weight:"219 –≥", brand:"Xiaomi"},
    {name:"Xiaomi 14", battery:"4610 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+50+50 –ú–ü", screen:'6.36" LTPO AMOLED 2670x1200 120–ì—Ü', charging:"90 –í—Ç", price:"899", storage:"256 –ì–ë", os:"HyperOS", weight:"188 –≥", brand:"Xiaomi"},
    {name:"Redmi Note 13 Pro", battery:"5100 mAh", materials:"–°—Ç–µ–∫–ª–æ", processor:"Snapdragon 7s Gen 2", camera:"200+8+2 –ú–ü", screen:'6.67" AMOLED 2712x1220 120–ì—Ü', charging:"67 –í—Ç", price:"399", storage:"256 –ì–ë", os:"HyperOS", weight:"187 –≥", brand:"Xiaomi"},
    {name:"Realme GT 5 Pro", battery:"5400 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+50+8 –ú–ü", screen:'6.78" AMOLED 2780x1264 120–ì—Ü', charging:"100 –í—Ç", price:"749", storage:"512 –ì–ë", os:"Realme UI 5", weight:"218 –≥", brand:"Realme"},
    {name:"Vivo X100 Pro", battery:"5400 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Dimensity 9300", camera:"50+50+50 –ú–ü", screen:'6.78" LTPO AMOLED 2800x1260 120–ì—Ü', charging:"100 –í—Ç", price:"899", storage:"512 –ì–ë", os:"Funtouch OS 14", weight:"221 g", brand:"Vivo"},
    {name:"Oppo Find X7 Ultra", battery:"5000 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+50+50+50 –ú–ü", screen:'6.82" LTPO AMOLED 3168x1440 120–ì—Ü', charging:"100 –í—Ç", price:"1199", storage:"512 –ì–ë", os:"ColorOS 14", weight:"221 –≥", brand:"Oppo"},
    {name:"Asus ROG Phone 8", battery:"5500 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+13+32 –ú–ü", screen:'6.78" AMOLED 2448x1080 165–ì—Ü', charging:"65 –í—Ç", price:"1099", storage:"512 –ì–ë", os:"ROG UI", weight:"225 –≥", brand:"Asus"},
    {name:"Nothing Phone 2", battery:"4700 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –∞–ª—é–º–∏–Ω–∏–π", processor:"Snapdragon 8+ Gen 1", camera:"50+50 –ú–ü", screen:'6.7" LTPO OLED 2412x1080 120–ì—Ü', charging:"45 –í—Ç", price:"599", storage:"256 –ì–ë", os:"Nothing OS 2.5", weight:"201 –≥", brand:"Nothing"},
    {name:"Motorola Edge 40 Neo", battery:"5000 mAh", materials:"–í–µ–≥–∞–Ω—Å–∫–∞—è –∫–æ–∂–∞", processor:"Dimensity 7030", camera:"50+13 –ú–ü", screen:'6.55" pOLED 2400x1080 144–ì—Ü', charging:"68 –í—Ç", price:"449", storage:"256 –ì–ë", os:"Android 14", weight:"172 –≥", brand:"Motorola"},
    {name:"Honor Magic 6 Pro", battery:"5600 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+50+180 –ú–ü", screen:'6.8" LTPO OLED 2800x1280 120–ì—Ü', charging:"80 –í—Ç", price:"1099", storage:"512 –ì–ë", os:"MagicOS 8", weight:"229 –≥", brand:"Honor"},
    {name:"Sony Xperia 1 V", battery:"5000 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 2", camera:"52+12+12 –ú–ü", screen:'6.5" OLED 3840x1644 120–ì—Ü', charging:"30 –í—Ç", price:"1399", storage:"256 –ì–ë", os:"Android 14", weight:"187 –≥", brand:"Sony"},
    {name:"Huawei P60 Pro", battery:"4815 mAh", materials:"–ù–∞–Ω–æ-–∫—Ä–∏—Å—Ç–∞–ª–ª", processor:"Snapdragon 8+ Gen 1", camera:"48+13+48 –ú–ü", screen:'6.67" LTPO OLED 2700x1220 120–ì—Ü', charging:"88 –í—Ç", price:"1199", storage:"512 –ì–ë", os:"HarmonyOS 4", weight:"200 –≥", brand:"Huawei"},
    {name:"ZTE Nubia Z60 Ultra", battery:"6000 mAh", materials:"–°—Ç–µ–∫–ª–æ –∏ –º–µ—Ç–∞–ª–ª", processor:"Snapdragon 8 Gen 3", camera:"50+50+64 –ú–ü", screen:'6.8" AMOLED 2480x1116 120–ì—Ü', charging:"80 –í—Ç", price:"799", storage:"512 –ì–ë", os:"MyOS 14", weight:"246 –≥", brand:"ZTE"},
    {name:"CAT S75", battery:"5000 mAh", materials:"–†–µ–∑–∏–Ω–∞ –∏ –º–µ—Ç–∞–ª–ª", processor:"Dimensity 930", camera:"50+8 –ú–ü", screen:'6.6" IPS 2408x1080 120–ì—Ü', charging:"35 –í—Ç", price:"599", storage:"128 –ì–ë", os:"Android 13", weight:"268 –≥", brand:"CAT"},
    {name:"Fairphone 5", battery:"4200 mAh", materials:"–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –ø–ª–∞—Å—Ç–∏–∫", processor:"QCM6490", camera:"50+50 –ú–ü", screen:'6.46" OLED 2770x1224 90–ì—Ü', charging:"30 –í—Ç", price:"699", storage:"256 –ì–ë", os:"Android 13", weight:"212 –≥", brand:"Fairphone"}
];

// ========== –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
const attributes = {
    battery: "üîã –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä",
    materials: "üß± –ú–∞—Ç–µ—Ä–∏–∞–ª—ã",
    processor: "‚öô –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä",
    camera: "üì∏ –ö–∞–º–µ—Ä–∞",
    screen: "üñ• –≠–∫—Ä–∞–Ω",
    charging: "‚ö° –ó–∞—Ä—è–¥–∫–∞",
    price: "üí≤ –¶–µ–Ω–∞",
    storage: "üíæ –ü–∞–º—è—Ç—å",
    os: "üî∑ –û–°",
    weight: "‚öñÔ∏è –í–µ—Å"
};

let gameState = {
    player1: { 
        name: '–ò–≥—Ä–æ–∫ 1', 
        phone: null, 
        usedAttributes: new Set(), 
        knownAttributes: {}, 
        possiblePhones: [], 
        isActive: true 
    },
    player2: { 
        name: '–ò–≥—Ä–æ–∫ 2', 
        phone: null, 
        usedAttributes: new Set(), 
        knownAttributes: {}, 
        possiblePhones: [], 
        isActive: false 
    },
    currentPlayer: 1,
    round: 1,
    maxRounds: 20,
    gameActive: true,
    startTime: null,
    actionTaken: false  // –§–ª–∞–≥, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–∂–µ —Å–æ–≤–µ—Ä—à–µ–Ω–æ
};

// ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
document.addEventListener('DOMContentLoaded', () => {
    // –ü–æ–ª—É—á–∞–µ–º –∏–º–µ–Ω–∞ –∏–≥—Ä–æ–∫–æ–≤
    const player1Name = localStorage.getItem('player1Name');
    const player2Name = localStorage.getItem('player2Name');
    
    if (player1Name) gameState.player1.name = player1Name;
    if (player2Name) gameState.player2.name = player2Name;
    
    startNewGame();
    setupMusic();
    
    gameState.startTime = new Date();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
    initAutocomplete();
});

function startNewGame() {
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    gameState = {
        player1: { 
            name: gameState.player1.name, 
            phone: null, 
            usedAttributes: new Set(), 
            knownAttributes: {}, 
            possiblePhones: [], 
            isActive: true 
        },
        player2: { 
            name: gameState.player2.name, 
            phone: null, 
            usedAttributes: new Set(), 
            knownAttributes: {}, 
            possiblePhones: [], 
            isActive: false 
        },
        currentPlayer: 1,
        round: 1,
        maxRounds: 20,
        gameActive: true,
        startTime: new Date(),
        actionTaken: false
    };
    
    // –í—ã–±–∏—Ä–∞–µ–º —Ä–∞–Ω–¥–æ–º–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã
    gameState.player1.phone = getRandomPhone();
    
    // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ —Ç–µ–ª–µ—Ñ–æ–Ω—ã —Ä–∞–∑–Ω—ã–µ
    do {
        gameState.player2.phone = getRandomPhone();
    } while (gameState.player2.phone.name === gameState.player1.phone.name);
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–ø–∏—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
    gameState.player1.possiblePhones = [...phones];
    gameState.player2.possiblePhones = [...phones];
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateGameInterface();
    updateSidebars();
}

function getRandomPhone() {
    const randomIndex = Math.floor(Math.random() * phones.length);
    return phones[randomIndex];
}

function updateGameInterface() {
    const current = getCurrentPlayer();
    const opponent = getOpponentPlayer();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–Ω–Ω–µ—Ä —Å —Ö–æ–¥–æ–º
    document.getElementById('turnBanner').innerHTML = `
        <span style="color: var(--accent);">${current.name}</span>, –≤–∞—à —Ö–æ–¥!
        <div style="font-size: 16px; color: var(--text-secondary); margin-top: 10px;">
            –†–∞—É–Ω–¥ ${gameState.round}/${gameState.maxRounds}
        </div>
    `;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –∏ –∏–º—è —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    document.getElementById('currentPlayerAvatar').textContent = gameState.currentPlayer === 1 ? 'üë§' : 'üë•';
    document.getElementById('currentPlayerNameDisplay').textContent = current.name;
    document.getElementById('opponentPhoneName').textContent = '???';
    document.getElementById('knownAttributes').textContent = Object.keys(current.knownAttributes).length;
    document.getElementById('roundCounter').textContent = gameState.round;
    document.getElementById('possiblePhones').textContent = current.possiblePhones.length;
    document.getElementById('ownPhoneName').textContent = current.phone.name;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    const details = document.getElementById('ownPhoneDetails');
    details.innerHTML = `
        <div><strong>–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä:</strong> ${current.phone.processor}</div>
        <div><strong>–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä:</strong> ${current.phone.battery}</div>
        <div><strong>–ö–∞–º–µ—Ä–∞:</strong> ${current.phone.camera}</div>
        <div><strong>–≠–∫—Ä–∞–Ω:</strong> ${current.phone.screen}</div>
    `;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –±–ª–æ–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
    if (gameState.actionTaken) {
        // –î–µ–π—Å—Ç–≤–∏–µ —É–∂–µ —Å–æ–≤–µ—Ä—à–µ–Ω–æ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ö–æ–¥–∞
        document.getElementById('mainActionButtons').style.display = 'none';
        document.getElementById('guessField').style.display = 'none';
        document.getElementById('afterActionButtons').style.display = 'block';
    } else {
        // –î–µ–π—Å—Ç–≤–∏–µ –µ—â–µ –Ω–µ —Å–æ–≤–µ—Ä—à–µ–Ω–æ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        document.getElementById('mainActionButtons').style.display = 'flex';
        document.getElementById('guessField').style.display = 'none';
        document.getElementById('afterActionButtons').style.display = 'none';
    }
}

function updateSidebars() {
    // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–æ–∫–æ–≤—ã—Ö –º–µ–Ω—é
    document.getElementById('player1SidebarTitle').textContent = gameState.player1.name;
    document.getElementById('player2SidebarTitle').textContent = gameState.player2.name;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞ 1
    updatePlayerSidebar('player1', gameState.player1);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞ 2
    updatePlayerSidebar('player2', gameState.player2);
}

function updatePlayerSidebar(playerId, player) {
    const sidebar = document.getElementById(playerId + 'Attributes');
    sidebar.innerHTML = '';
    
    if (Object.keys(player.knownAttributes).length === 0) {
        sidebar.innerHTML = '<div class="no-attributes">–ï—â–µ –Ω–µ —Ä–∞—Å–∫—Ä—ã—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</div>';
        return;
    }
    
    Object.entries(player.knownAttributes).forEach(([attr, value]) => {
        const item = document.createElement('div');
        item.className = 'attribute-sidebar-item';
        item.innerHTML = `
            <div class="attribute-name">${attributes[attr]}</div>
            <div class="attribute-value">${value}</div>
        `;
        sidebar.appendChild(item);
    });
}

function getCurrentPlayer() {
    return gameState.currentPlayer === 1 ? gameState.player1 : gameState.player2;
}

function getOpponentPlayer() {
    return gameState.currentPlayer === 1 ? gameState.player2 : gameState.player1;
}

function showGuessField() {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –¥–ª—è —É–≥–∞–¥—ã–≤–∞–Ω–∏—è
    document.getElementById('mainActionButtons').style.display = 'none';
    document.getElementById('guessField').style.display = 'block';
    document.getElementById('afterActionButtons').style.display = 'none';
    
    // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
    document.getElementById('guessInput').value = '';
    document.getElementById('guessSuggestions').style.display = 'none';
}

function cancelGuess() {
    // –û—Ç–º–µ–Ω—è–µ–º —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≤—ã–±–æ—Ä—É –¥–µ–π—Å—Ç–≤–∏—è
    document.getElementById('mainActionButtons').style.display = 'flex';
    document.getElementById('guessField').style.display = 'none';
    document.getElementById('afterActionButtons').style.display = 'none';
}

function openAskModal() {
    const modal = document.getElementById('askModal');
    const current = getCurrentPlayer();
    const opponent = getOpponentPlayer();
    
    document.getElementById('askModalSubtitle').textContent = `–£–∑–Ω–∞–π—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ${opponent.name}`;
    
    createAttributeButtons();
    
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function closeAskModal() {
    document.getElementById('askModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

function createAttributeButtons() {
    const current = getCurrentPlayer();
    const grid = document.getElementById('attributesGrid');
    grid.innerHTML = '';
    
    Object.entries(attributes).forEach(([attr, name]) => {
        const card = document.createElement('div');
        card.className = `attr-card ${current.usedAttributes.has(attr) ? 'used' : ''}`;
        card.dataset.attr = attr;
        
        if (!current.usedAttributes.has(attr)) {
            card.onclick = () => askAttribute(attr);
        }
        
        const icons = {
            battery: 'üîã', materials: 'üß±', processor: '‚öôÔ∏è', camera: 'üì∏',
            screen: 'üñ•Ô∏è', charging: '‚ö°', price: 'üí∞', storage: 'üíæ',
            os: 'üî∑', weight: '‚öñÔ∏è'
        };
        
        card.innerHTML = `
            <div class="attr-icon">${icons[attr] || 'üìã'}</div>
            <div class="attr-name">${name}</div>
            ${current.usedAttributes.has(attr) ? 
              '<div style="color: #8a2be2; font-size: 12px; margin-top: 10px;">–£–∂–µ —Å–ø—Ä–∞—à–∏–≤–∞–ª–∏</div>' : 
              '<div style="color: var(--success); font-size: 12px; margin-top: 10px;">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</div>'}
        `;
        
        grid.appendChild(card);
    });
}

function askAttribute(attr) {
    const current = getCurrentPlayer();
    const opponent = getOpponentPlayer();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞—Ç—Ä–∏–±—É—Ç –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ
    current.usedAttributes.add(attr);
    
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ —É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –æ–ø–ø–æ–Ω–µ–Ω—Ç–∞
    const value = opponent.phone[attr];
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
    current.knownAttributes[attr] = value;
    
    // –§–∏–ª—å—Ç—Ä—É–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ç–µ–ª–µ—Ñ–æ–Ω—ã
    current.possiblePhones = current.possiblePhones.filter(phone => {
        return phone[attr] === value;
    });
    
    // –î–µ–π—Å—Ç–≤–∏–µ —Å–æ–≤–µ—Ä—à–µ–Ω–æ
    gameState.actionTaken = true;
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    closeAskModal();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é
    updateSidebars();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateGameInterface();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    showResultModal(attr, value);
}

function showResultModal(attr, value) {
    const current = getCurrentPlayer();
    const modal = document.getElementById('resultModal');
    
    document.getElementById('resultTitle').textContent = '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∞!';
    document.getElementById('resultSubtitle').textContent = `–í—ã —É–∑–Ω–∞–ª–∏ ${attributes[attr].toLowerCase()} —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞`;
    document.getElementById('resultPhoneName').textContent = value;
    document.getElementById('resultAttribute').textContent = attributes[attr];
    document.getElementById('resultKnownCount').textContent = Object.keys(current.knownAttributes).length;
    document.getElementById('resultPossibleCount').textContent = current.possiblePhones.length;
    
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function closeResultModal() {
    document.getElementById('resultModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

function initAutocomplete() {
    const guessInput = document.getElementById('guessInput');
    const suggestions = document.getElementById('guessSuggestions');
    
    guessInput.addEventListener('input', function() {
        const query = this.value.toLowerCase();
        suggestions.innerHTML = '';
        
        if (query.length < 2) {
            suggestions.style.display = 'none';
            return;
        }
        
        const matches = phones.filter(phone => 
            phone.name.toLowerCase().includes(query)
        ).slice(0, 8);
        
        if (matches.length > 0) {
            matches.forEach(phone => {
                const item = document.createElement('div');
                item.className = 'suggestion-item';
                item.innerHTML = `
                    <div style="font-weight: bold; color: var(--accent);">${phone.name}</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 5px;">
                        ${phone.processor} ‚Ä¢ ${phone.camera} ‚Ä¢ ${phone.screen}
                    </div>
                `;
                item.onclick = () => {
                    guessInput.value = phone.name;
                    suggestions.style.display = 'none';
                };
                suggestions.appendChild(item);
            });
            suggestions.style.display = 'block';
        } else {
            suggestions.style.display = 'none';
        }
    });
    
    // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –ø–æ–ª—è
    document.addEventListener('click', function(e) {
        if (!guessInput.contains(e.target) && !suggestions.contains(e.target)) {
            suggestions.style.display = 'none';
        }
    });
}

function submitGuess() {
    const input = document.getElementById('guessInput');
    const guess = input.value.trim();
    
    if (!guess) {
        alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞!');
        return;
    }
    
    const current = getCurrentPlayer();
    const opponent = getOpponentPlayer();
    
    // –ò—â–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∏ –ø—Ä–æ–±–µ–ª–æ–≤
    const guessedPhone = phones.find(p => 
        p.name.toLowerCase() === guess.toLowerCase()
    );
    
    if (!guessedPhone) {
        alert('–¢–∞–∫–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–µ—Ç –≤ –±–∞–∑–µ!');
        return;
    }
    
    if (guessedPhone.name === opponent.phone.name) {
        endGame(true, guessedPhone.name);
    } else {
        alert(`–ù–µ–≤–µ—Ä–Ω–æ! –≠—Ç–æ –Ω–µ ${guessedPhone.name}`);
        // –£–¥–∞–ª—è–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–≥–∞–¥–∞–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö
        current.possiblePhones = current.possiblePhones.filter(phone => phone.name !== guessedPhone.name);
        
        // –î–µ–π—Å—Ç–≤–∏–µ —Å–æ–≤–µ—Ä—à–µ–Ω–æ
        gameState.actionTaken = true;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateGameInterface();
    }
}

function nextTurn() {
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –¥–µ–π—Å—Ç–≤–∏—è
    gameState.actionTaken = false;
    
    // –ú–µ–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞
    gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
    gameState.round++;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å –ª–∏ –∏–≥—Ä–∞
    if (gameState.round > gameState.maxRounds) {
        endGame(false);
        return;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    updateGameInterface();
}

function endGame(isWin, guessedPhone = null) {
    gameState.gameActive = false;
    
    const current = getCurrentPlayer();
    const opponent = getOpponentPlayer();
    const modal = document.getElementById('endGameModal');
    
    if (isWin) {
        document.getElementById('endGameTitle').textContent = '–ü–û–ë–ï–î–ê!';
        document.getElementById('endGameIcon').textContent = 'üéâ';
        document.getElementById('endGameMessage').textContent = `${current.name} —É–≥–∞–¥–∞–ª —Ç–µ–ª–µ—Ñ–æ–Ω ${opponent.name}: ${guessedPhone}`;
    } else {
        document.getElementById('endGameTitle').textContent = '–í–†–ï–ú–Ø –í–´–®–õ–û!';
        document.getElementById('endGameIcon').textContent = 'ü§ù';
        document.getElementById('endGameMessage').textContent = '–õ–∏–º–∏—Ç —Ä–∞—É–Ω–¥–æ–≤ –∏—Å—á–µ—Ä–ø–∞–Ω. –ù–∏—á—å—è!';
    }
    
    document.getElementById('player1EndName').textContent = gameState.player1.name;
    document.getElementById('player1EndPhone').textContent = gameState.player1.phone.name;
    document.getElementById('player2EndName').textContent = gameState.player2.name;
    document.getElementById('player2EndPhone').textContent = gameState.player2.phone.name;
    
    document.getElementById('endGameRounds').textContent = gameState.round - 1;
    document.getElementById('endGameTime').textContent = getGameTime();
    
    updateGameStatistics(isWin ? current.name : null);
    
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function getGameTime() {
    if (!gameState.startTime) return '0:00';
    const diff = new Date() - gameState.startTime;
    const minutes = Math.floor(diff / 60000);
    const seconds = Math.floor((diff % 60000) / 1000);
    return `${minutes}:${seconds.toString().padStart(2, '0')}`;
}

function updateGameStatistics(winner) {
    let totalGames = parseInt(localStorage.getItem('gamesPlayed') || '0');
    totalGames++;
    localStorage.setItem('gamesPlayed', totalGames);
    
    if (winner) {
        let player1Wins = parseInt(localStorage.getItem('player1Wins') || '0');
        let player2Wins = parseInt(localStorage.getItem('player2Wins') || '0');
        
        if (winner === gameState.player1.name) {
            player1Wins++;
            localStorage.setItem('player1Wins', player1Wins);
        } else {
            player2Wins++;
            localStorage.setItem('player2Wins', player2Wins);
        }
    }
}

function restartGame() {
    document.getElementById('endGameModal').style.display = 'none';
    document.body.style.overflow = 'auto';
    startNewGame();
}

function setupMusic() {
    const music = document.getElementById('bgMusic');
    const toggleBtn = document.getElementById('musicToggle');
    let musicEnabled = localStorage.getItem('musicEnabled') !== 'false';
    
    if (musicEnabled) {
        music.play().catch(() => {
            musicEnabled = false;
            toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: OFF";
        });
        toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: ON";
    } else {
        music.pause();
        toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: OFF";
    }
    
    toggleBtn.addEventListener('click', () => {
        if(musicEnabled) {
            music.pause();
            toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: OFF";
            musicEnabled = false;
        } else {
            music.play();
            toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: ON";
            musicEnabled = true;
        }
        localStorage.setItem('musicEnabled', musicEnabled);
    });
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        closeAskModal();
        closeResultModal();
    }
});
</script>
</body>
</html>
