<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Duel duel player</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .online-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .connection-status {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 2px solid;
            transition: all 0.3s;
        }
        
        .status-connected {
            border-color: var(--success);
            box-shadow: 0 0 20px rgba(15, 248, 209, 0.3);
        }
        
        .status-disconnected {
            border-color: var(--danger);
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.3);
        }
        
        .status-waiting {
            border-color: var(--warning);
            box-shadow: 0 0 20px rgba(255, 140, 0, 0.3);
            animation: pulse 2s infinite;
        }
        
        .status-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .status-message {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .room-info {
            background: rgba(16, 16, 38, 0.6);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .room-code {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent);
            letter-spacing: 3px;
        }
        
        .copy-btn {
            background: rgba(8, 240, 255, 0.2);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 8px 15px;
            color: white;
            cursor: pointer;
            font-family: 'Share Tech Mono', monospace;
        }
        
        .copy-btn:hover {
            background: rgba(8, 240, 255, 0.4);
        }
        
        .players-online {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        
        .player-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid var(--accent-light);
            transition: all 0.3s;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .player-card.active {
            border-color: var(--accent);
            box-shadow: 0 0 20px rgba(8, 240, 255, 0.3);
        }
        
        .player-avatar {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .player-name {
            font-size: 22px;
            color: var(--accent);
            margin-bottom: 10px;
        }
        
        .player-ready {
            color: var(--success);
            font-size: 14px;
            margin-top: 10px;
        }
        
        .player-waiting {
            color: var(--warning);
            font-size: 14px;
            margin-top: 10px;
        }
        
        .chat-container {
            margin-top: 30px;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid var(--accent-light);
        }
        
        .chat-messages {
            height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(10, 10, 24, 0.7);
            border-radius: 8px;
        }
        
        .message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            background: rgba(16, 16, 38, 0.5);
        }
        
        .message.system {
            border-left: 3px solid var(--accent);
            color: var(--accent);
            font-size: 13px;
        }
        
        .message.player {
            border-left: 3px solid var(--success);
        }
        
        .message.opponent {
            border-left: 3px solid var(--accent-secondary);
        }
        
        .message-sender {
            font-weight: bold;
            color: var(--accent);
            margin-right: 8px;
        }
        
        .chat-input-container {
            display: flex;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px;
            background: rgba(16, 16, 38, 0.8);
            border: 1px solid var(--accent-light);
            border-radius: 8px;
            color: white;
            font-family: 'Share Tech Mono', monospace;
        }
        
        .chat-send {
            padding: 12px 25px;
            background: linear-gradient(90deg, var(--accent), var(--success));
            border: none;
            border-radius: 8px;
            color: black;
            font-weight: bold;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
        }
        
        .game-controls-online {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }
        
        .ready-btn {
            padding: 15px 40px;
            background: linear-gradient(90deg, var(--success), #00ffaa);
            border: none;
            border-radius: 10px;
            color: black;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
        }
        
        .leave-btn {
            padding: 15px 40px;
            background: linear-gradient(90deg, var(--danger), #ff6666);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
        }
        
        .ready-btn:hover, .leave-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .ready-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .invite-link {
            margin-top: 20px;
            padding: 15px;
            background: rgba(16, 16, 38, 0.8);
            border-radius: 10px;
            border: 1px solid var(--accent-light);
            text-align: center;
        }
        
        .invite-text {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }
        
        .invite-url {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 5px;
            font-family: 'Share Tech Mono', monospace;
            word-break: break-all;
            color: var(--accent);
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="window.location.href='index.html'">‚Üê –ù–∞–∑–∞–¥</button>
    
    <div class="online-container">
        <h1>üåê –û–Ω–ª–∞–π–Ω –î—É—ç–ª—å</h1>
        
        <!-- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
        <div class="connection-status" id="connectionStatus">
            <div class="status-icon" id="statusIcon">üîå</div>
            <div class="status-message" id="statusMessage">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É...</div>
            <div id="statusDetails">–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤</div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–Ω–∞—Ç–µ -->
        <div class="room-info">
            <div>
                <div style="color: var(--text-secondary); font-size: 14px;">–ö–æ–º–Ω–∞—Ç–∞:</div>
                <div class="room-code" id="roomCodeDisplay">DUEL-0000</div>
            </div>
            <button class="copy-btn" onclick="copyRoomCode()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
        </div>
        
        <!-- –ò–≥—Ä–æ–∫–∏ –æ–Ω–ª–∞–π–Ω -->
        <div class="players-online">
            <div class="player-card" id="playerCard1">
                <div class="player-avatar">üë§</div>
                <div class="player-name" id="playerName1">–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</div>
                <div class="player-waiting" id="playerStatus1">–ù–µ –≥–æ—Ç–æ–≤</div>
            </div>
            
            <div class="player-card" id="playerCard2">
                <div class="player-avatar">üë§</div>
                <div class="player-name" id="playerName2">–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...</div>
                <div class="player-waiting" id="playerStatus2">–ù–µ –≥–æ—Ç–æ–≤</div>
            </div>
        </div>
        
        <!-- –ß–∞—Ç -->
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="message system">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Phone Duel Online!</div>
                <div class="message system">–û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞...</div>
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="200">
                <button class="chat-send" id="chatSend" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
        
        <!-- –ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ö–æ—Å—Ç–∞) -->
        <div class="invite-link" id="inviteLink" style="display: none;">
            <div class="invite-text">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç–µ –¥—Ä—É–≥–∞, –æ—Ç–ø—Ä–∞–≤–∏–≤ –µ–º—É —ç—Ç—É —Å—Å—ã–ª–∫—É:</div>
            <div class="invite-url" id="inviteUrl"></div>
        </div>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π -->
        <div class="game-controls-online">
            <button class="ready-btn" id="readyBtn" onclick="toggleReady()">–ì–û–¢–û–í</button>
            <button class="leave-btn" onclick="leaveRoom()">–ü–û–ö–ò–ù–£–¢–¨ –ö–û–ú–ù–ê–¢–£</button>
        </div>
    </div>
    
    <!-- –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞ -->
    <audio id="bgMusic" loop>
        <source src="cyberpunk_music.mp3" type="audio/mpeg">
    </audio>
    <button id="musicToggle" class="music-btn">–ú—É–∑—ã–∫–∞: ON</button>
    
    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
        const playerData = {
            name: localStorage.getItem('playerName') || '–ò–≥—Ä–æ–∫',
            roomCode: localStorage.getItem('roomCode') || '0000',
            isHost: localStorage.getItem('isHost') === 'true',
            isReady: false,
            socket: null
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã
        const roomState = {
            players: {},
            gameStarted: false,
            currentTurn: null,
            chatHistory: []
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
            document.getElementById('roomCodeDisplay').textContent = `DUEL-${playerData.roomCode}`;
            document.getElementById('playerName1').textContent = playerData.name;
            
            // –ï—Å–ª–∏ —Ö–æ—Å—Ç, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
            if (playerData.isHost) {
                document.getElementById('inviteLink').style.display = 'block';
                const inviteUrl = `${window.location.origin}${window.location.pathname}?room=${playerData.roomCode}`;
                document.getElementById('inviteUrl').textContent = inviteUrl;
            }
            
            // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É (—ç–º—É–ª—è—Ü–∏—è –¥–ª—è –¥–µ–º–æ)
            connectToServer();
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—É–∑—ã–∫–æ–π
            setupMusic();
        });
        
        // –≠–º—É–ª—è—Ü–∏—è WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        function connectToServer() {
            const status = document.getElementById('connectionStatus');
            const statusIcon = document.getElementById('statusIcon');
            const statusMessage = document.getElementById('statusMessage');
            const statusDetails = document.getElementById('statusDetails');
            
            // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            setTimeout(() => {
                status.className = 'connection-status status-connected';
                statusIcon.textContent = '‚úÖ';
                statusMessage.textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ä–≤–µ—Ä—É';
                statusDetails.textContent = playerData.isHost ? 
                    '–í—ã —Å–æ–∑–¥–∞—Ç–µ–ª—å –∫–æ–º–Ω–∞—Ç—ã. –û–∂–∏–¥–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞.' : 
                    '–í—ã –ø–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ. –û–∂–∏–¥–∞–π—Ç–µ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã.';
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–µ–±—è –≤ —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤
                roomState.players[playerData.name] = {
                    name: playerData.name,
                    isHost: playerData.isHost,
                    isReady: false,
                    avatar: 'üë§'
                };
                
                updatePlayersDisplay();
                addChatMessage('system', '–í—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –∫–æ–º–Ω–∞—Ç–µ!');
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (–¥–ª—è –¥–µ–º–æ)
                if (playerData.isHost) {
                    setTimeout(() => {
                        addSecondPlayer();
                    }, 2000);
                }
                
            }, 1500);
        }
        
        function addSecondPlayer() {
            const botName = playerData.isHost ? '–û–ø–ø–æ–Ω–µ–Ω—Ç' : '–°–æ–∑–¥–∞—Ç–µ–ª—å –∫–æ–º–Ω–∞—Ç—ã';
            roomState.players[botName] = {
                name: botName,
                isHost: !playerData.isHost,
                isReady: false,
                avatar: 'ü§ñ'
            };
            
            updatePlayersDisplay();
            addChatMessage('system', `${botName} –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ!`);
            addChatMessage('opponent', '–ü—Ä–∏–≤–µ—Ç! –ì–æ—Ç–æ–≤ –∏–≥—Ä–∞—Ç—å?');
        }
        
        function updatePlayersDisplay() {
            const players = Object.values(roomState.players);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
            if (players[0]) {
                document.getElementById('playerName1').textContent = players[0].name;
                document.getElementById('playerStatus1').textContent = players[0].isReady ? '–ì–æ—Ç–æ–≤' : '–ù–µ –≥–æ—Ç–æ–≤';
                document.getElementById('playerStatus1').className = players[0].isReady ? 'player-ready' : 'player-waiting';
                document.getElementById('playerCard1').querySelector('.player-avatar').textContent = players[0].avatar;
                
                if (players[0].name === playerData.name) {
                    document.getElementById('playerCard1').classList.add('active');
                } else {
                    document.getElementById('playerCard1').classList.remove('active');
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞
            if (players[1]) {
                document.getElementById('playerName2').textContent = players[1].name;
                document.getElementById('playerStatus2').textContent = players[1].isReady ? '–ì–æ—Ç–æ–≤' : '–ù–µ –≥–æ—Ç–æ–≤';
                document.getElementById('playerStatus2').className = players[1].isReady ? 'player-ready' : 'player-waiting';
                document.getElementById('playerCard2').querySelector('.player-avatar').textContent = players[1].avatar;
                
                if (players[1].name === playerData.name) {
                    document.getElementById('playerCard2').classList.add('active');
                } else {
                    document.getElementById('playerCard2').classList.remove('active');
                }
            } else {
                document.getElementById('playerName2').textContent = '–û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞...';
                document.getElementById('playerStatus2').textContent = '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
                document.getElementById('playerStatus2').className = 'player-waiting';
                document.getElementById('playerCard2').classList.remove('active');
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É
            checkGameStart();
        }
        
        function toggleReady() {
            playerData.isReady = !playerData.isReady;
            roomState.players[playerData.name].isReady = playerData.isReady;
            
            const readyBtn = document.getElementById('readyBtn');
            if (playerData.isReady) {
                readyBtn.textContent = '–û–¢–ú–ï–ù–ò–¢–¨';
                readyBtn.style.background = 'linear-gradient(90deg, var(--warning), #ffaa00)';
                addChatMessage('system', `${playerData.name} –≥–æ—Ç–æ–≤ –∫ –∏–≥—Ä–µ!`);
            } else {
                readyBtn.textContent = '–ì–û–¢–û–í';
                readyBtn.style.background = 'linear-gradient(90deg, var(--success), #00ffaa)';
                addChatMessage('system', `${playerData.name} –æ—Ç–º–µ–Ω–∏–ª –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å`);
            }
            
            updatePlayersDisplay();
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞
            if (Object.keys(roomState.players).length > 1) {
                const opponentName = Object.keys(roomState.players).find(name => name !== playerData.name);
                if (opponentName && !roomState.players[opponentName].isReady && playerData.isReady) {
                    setTimeout(() => {
                        roomState.players[opponentName].isReady = true;
                        updatePlayersDisplay();
                        addChatMessage('opponent', '–Ø —Ç–æ–∂–µ –≥–æ—Ç–æ–≤! –ù–∞—á–∏–Ω–∞–µ–º?');
                    }, 1000);
                }
            }
        }
        
        function checkGameStart() {
            const players = Object.values(roomState.players);
            const allReady = players.length === 2 && players.every(p => p.isReady);
            
            if (allReady && !roomState.gameStarted) {
                roomState.gameStarted = true;
                addChatMessage('system', '–û–±–∞ –∏–≥—Ä–æ–∫–∞ –≥–æ—Ç–æ–≤—ã! –ù–∞—á–∏–Ω–∞–µ–º –∏–≥—Ä—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã...');
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
                document.getElementById('readyBtn').disabled = true;
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
                setTimeout(startOnlineGame, 3000);
            }
        }
        
        function startOnlineGame() {
            addChatMessage('system', 'üéÆ –ò–ì–†–ê –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø!');
            addChatMessage('system', '–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ...');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã
            localStorage.setItem('onlinePlayers', JSON.stringify(roomState.players));
            localStorage.setItem('playerRole', playerData.isHost ? 'host' : 'guest');
            
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –∏–≥—Ä–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            setTimeout(() => {
                window.location.href = 'game-online.html';
            }, 2000);
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage('player', message);
                input.value = '';
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
                if (Object.keys(roomState.players).length > 1) {
                    setTimeout(() => {
                        const responses = [
                            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ!",
                            "–•–æ—Ä–æ—à–∏–π –≤—ã–±–æ—Ä!",
                            "–£ –º–µ–Ω—è –ø–æ—Ö–æ–∂–∏–π —Ç–µ–ª–µ—Ñ–æ–Ω",
                            "–ñ–¥—É –Ω–µ –¥–æ–∂–¥—É—Å—å –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã!",
                            "–£–¥–∞—á–∏!",
                            "–î–∞–≤–∞–π —Å—ã–≥—Ä–∞–µ–º!"
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        addChatMessage('opponent', randomResponse);
                    }, 1000);
                }
            }
        }
        
        function addChatMessage(type, content) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            let sender = '';
            if (type === 'player') {
                sender = `<span class="message-sender">–í—ã:</span>`;
            } else if (type === 'opponent') {
                const opponentName = Object.keys(roomState.players).find(name => name !== playerData.name) || '–û–ø–ø–æ–Ω–µ–Ω—Ç';
                sender = `<span class="message-sender">${opponentName}:</span>`;
            }
            
            messageDiv.innerHTML = `${sender}${content}`;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            roomState.chatHistory.push({ type, content, timestamp: new Date() });
        }
        
        function copyRoomCode() {
            const roomCode = playerData.roomCode;
            navigator.clipboard.writeText(roomCode).then(() => {
                alert(`–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã ${roomCode} —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!`);
            });
        }
        
        function leaveRoom() {
            if (confirm('–ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É?')) {
                localStorage.removeItem('roomCode');
                localStorage.removeItem('isHost');
                window.location.href = 'index.html';
            }
        }
        
        function setupMusic() {
            const music = document.getElementById('bgMusic');
            const toggleBtn = document.getElementById('musicToggle');
            let musicEnabled = true;
            
            music.play().catch(() => {
                musicEnabled = false;
                toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: OFF";
            });
            
            toggleBtn.addEventListener('click', () => {
                if(musicEnabled) {
                    music.pause();
                    toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: OFF";
                    musicEnabled = false;
                } else {
                    music.play();
                    toggleBtn.textContent = "–ú—É–∑—ã–∫–∞: ON";
                    musicEnabled = true;
                }
            });
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏ –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const roomFromUrl = urlParams.get('room');
        if (roomFromUrl && !playerData.roomCode) {
            playerData.roomCode = roomFromUrl;
            playerData.isHost = false;
            localStorage.setItem('roomCode', roomFromUrl);
            localStorage.setItem('isHost', 'false');
        }
    </script>
</body>

</html>
